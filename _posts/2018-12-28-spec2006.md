---
title: "SPEC2006重新编译遇到的问题"
date: 2018-12-28 21:30:23 +0800
category: Markdown
tags: [Markdown, Minimalism]
excerpt: 高版本ubuntu 16.04在spec2006没有注册，需要对源码重新编译。本文列举出本地编译spec2006遇到的所有问题，供参考。
---

遇到的问题：
        
        高版本ubuntu 16.04在spec2006没有注册，需要对源码重新编译。本文列举出本地编译spec2006遇到的所有问题，供参考。

硬件环境：
         
         x86_64（Intel(R) Xeon(R) CPU E7- 4820  @ 2.00GHz）

操作系统：

         Ubuntu 16.04.3 LTS  

源代码：

         spec2006.tar.bz2



编译过程：

第一步：解压缩tools/src源码
```
    $ tar jxvf spec2006.tar.bz2
    $ cd spec2006/tools/
    $ tar jxvf tools_src.tar.bz2
    $ cd 
```

第二步：修改编译过程遇到的问题

##### (1) (command-line)
  
```
    a.) Add a line(shown below) in tools/src/perl-*/makedepend.SH:

             -e '/^#.*<builtin>/d' \
             -e '/^#.*<built-in>/d' \
             -e '/^#.*<command line>/d' \
    +            -e '/^#.*<command-line>/d' \ <-- ADD THIS LINE
             -e '/^#.*"-"/d' \
             -e '/: file path prefix .* never used$/d' \
```

##### (2)#defined size_t unsigned
```
注释掉src/specmd5sum/configure 1959行的#defined size_t unsigned
```
##### (3)getline
```
注释掉tools/src/specmd5sum/md5sum.c中getline.h头文件（38行）
```
##### (4)error building perl
```
    ./tools/src/perl-5.8.8/ext/IPC/SysV/SysV.xs文件，注释asm/page.h头文件（7行）
```
#### (5)pow、floor等数学库函数找不到
```
    ./tools/src/buildtools中300+行的export替换成：export PERLFLAGS="-A libs=-lm -A libs=-ldl"
    LD_LIBRARY_PATH=`pwd`
    DYLD_LIBRARY_PATH=`pwd`
    export LD_LIBRARY_PATH DYLD_LIBRARY_PATH
```
#### (6)You haven’t done a “make depend” yet!

``` 
    sudo rm /bin/sh
    sudo ln –s /bin/bash /bin/sh
```

#### (7)Compress-Bzip2 and -fpic

在src/buildtool的176行附近添加：BZIP2CFLAGS=-fPIC

```
    # Fool autoconf and friends
    BZIP2CFLAGS=-fPIC
    find . $FOOL_AC_FILES -print | xargs touch
```

#### (8)./src/buildtools完之后再重新install.sh才能将你的architecture注册进去.

    测试：runspec --config=minifat-O2.cfg --rebuild --size=test --iterations=1 --tune=base mcf

第三步：回到主目录重新install.sh才能将你的architecture注册进去。

    $ cd ~/spec2006
    $ ./install.sh

第四步：使用已有配置文件进行测试

    测试：runspec --config=minifat-O2.cfg --rebuild --size=test --iterations=1 --tune=base mcf
    

SPEC2006：12个C + 7个C++ = 19子集

`12个C : [1]perlbench(c)[2]bzip2(c)[3]gcc(c)[4]mcf(c)[5]milc(c)[6]gobmk(c)[7]hmmer(c)[8]sjeng(c)
    [9]libquantum(c)[10]h264ref(c)[11]lbm(c)[12]sphinx3(c)`

`7个C++:[13]namd(C++)[14]dealII(C++)[15]soplex(C++)[16]xalancbmk(C++)[17]povray(C++)[18]omnetpp(C++)[19]astar(C++)`

